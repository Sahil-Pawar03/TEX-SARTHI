<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TexSaarthi - Orders</title>
  <link rel="stylesheet" href="styles.css">
    <script src="auth.js" defer></script>
    <script src="api.js" defer></script>
  <style>
    .actions button { margin-right: 6px; }
  </style>
  </head>
<body>
  <aside class="sidebar">
    <div class="brand">TexSaarthi</div>
    <nav>
      <a href="index.html">Dashboard</a>
      <a class="active" href="orders.html">Orders</a>
      <a href="invoices.html">Invoices</a>
      <a href="inventory.html">Inventory</a>
      <a href="deliveries.html">Deliveries</a>
      <a href="customers.html">Customers</a>
      <a href="reports.html">Reports</a>
      <a href="settings.html">Settings</a>
    </nav>
  </aside>

  <main class="content">
    <header class="topbar">
      <h1>Orders Management</h1>
      <div>
        <span id="welcome-user" class="hidden" style="margin-right:8px;"></span>
        <a class="btn primary" href="add-order.html">Add New Order</a>
      </div>
    </header>

    <div class="panel">
      <div class="searchbar">
        <input type="text" placeholder="Search orders by customer or order number...">
        <select>
          <option>All Status</option>
          <option>in progress</option>
          <option>ready</option>
          <option>received</option>
        </select>
        <button class="btn light">Filter</button>
      </div>
      <table>
        <thead>
          <tr>
            <th>Order #</th>
            <th>Customer</th>
            <th>Type</th>
            <th>Fabric</th>
            <th>Quantity</th>
            <th>Delivery Date</th>
            <th>Value</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody id="orders-body"></tbody>
      </table>
    </div>
  </main>
  <script>
    (function(){
      var body = document.getElementById('orders-body');
      if (!body) return;
      var stored = [];
      try { stored = JSON.parse(localStorage.getItem('orders_list') || '[]'); } catch(_) {}
      if (!Array.isArray(stored) || stored.length === 0) return;
      function statusClass(s){
        var v = String(s || '').toLowerCase().trim();
        if (v === 'ready' || v === 'completed') return 'green';
        if (v === 'received') return 'blue';
        if (v.indexOf('progress') !== -1) return 'yellow';
        return 'red';
      }
      stored.forEach(function(o){
        var tr = document.createElement('tr');
        // Map exactly to the table columns (no Color/Units here)
        var cells = [
          o.orderNo || '',
          o.customer || '',
          o.type || '',
          o.fabric || '',
          o.qty || '',
          o.delivery || '',
          o.value || '',
        ];
        cells.forEach(function(text){
          var td = document.createElement('td');
          td.textContent = text;
          tr.appendChild(td);
        });
        var statusTd = document.createElement('td');
        var span = document.createElement('span');
        span.className = 'status ' + statusClass(o.status);
        span.textContent = (o.status || '').toString();
        statusTd.appendChild(span);
        tr.appendChild(statusTd);

        var actions = document.createElement('td');
        actions.className = 'actions';
        actions.innerHTML = '<button class="btn elevated">View</button> <button class="btn elevated">Edit</button>';
        tr.appendChild(actions);
        body.appendChild(tr);
      });
    })();
  </script>
</body>
</html>


